{% extends 'hospital/admin_base.html' %}
{% load static %}
{% block content %}

<div class="container my-5" id="invoice-box">
  <div class="card shadow">
    <div class="card-header bg-success text-white text-center">
      <h4>Final Invoice - Patient Discharge Summary</h4>
    </div>
    <div class="card-body">

      <div class="row mb-3">
        <div class="col-md-6">
          <h5>Hospital Management (UK)</h5>
          <p><strong>Patient:</strong> {{ name }}</p>
          <p><strong>Mobile:</strong> {{ mobile }}</p>
          <p><strong>Address:</strong> {{ address }}</p>
        </div>
        <div class="col-md-6 text-md-end">
          <p><strong>Doctor:</strong> {{ assignedDoctorName }}</p>
          <p><strong>Admit Date:</strong> {{ admitDate }}</p>
          <p><strong>Discharge Date:</strong> {{ todayDate }}</p>
          <p><strong>Total Days:</strong> {{ day }}</p>
        </div>
      </div>

      <hr>
      <h5>Symptoms</h5>
      <p>{{ symptoms }}</p>

      <h5 class="mt-4">Billing Breakdown</h5>
      <table class="table table-bordered">
        <thead class="table-secondary">
          <tr>
            <th>Service</th>
            <th>Cost (£)</th>
          </tr>
        </thead>
        <tbody>
          <tr>
            <td>Room Charges ({{ day }} days)</td>
            <td>£{{ roomCharge }}</td>
          </tr>
          <tr>
            <td>Doctor Consultation Fee</td>
            <td>£{{ doctorFee }}</td>
          </tr>
          <tr>
            <td>Medicine Cost</td>
            <td>£{{ medicineCost }}</td>
          </tr>
          <tr>
            <td>Other Charges</td>
            <td>£{{ OtherCharge }}</td>
          </tr>
          <tr class="table-success">
            <td><strong>Total Due</strong></td>
            <td><strong>£{{ total }}</strong></td>
          </tr>
        </tbody>
      </table>

      <div class="text-center mt-4">
        <a href="{% url 'download-pdf' patientId %}" class="btn btn-primary">Download PDF</a>
        <button onclick="printInvoice()" class="btn btn-secondary">Print Invoice</button>
      </div>

    </div>
  </div>
</div>

<script>
  function printInvoice() {
    const invoice = document.getElementById("invoice-box").innerHTML;
    const originalContent = document.body.innerHTML;
    document.body.innerHTML = invoice;
    window.print();
    document.body.innerHTML = originalContent;
    window.location.reload();
  }
</script>

{% endblock content %}
