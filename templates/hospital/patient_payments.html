{% extends 'hospital/patient_base.html' %}
{% load static %}
{% block content %}

<div class="container mt-5">
  <h3 class="mb-3">Payments</h3>

  {% if not discharge %}
    <div class="alert alert-info">
      You do not have any discharge records yet. Payments will appear here once discharged.
    </div>
  {% else %}
    <div class="card">
      <div class="card-body">
        <p><strong>Discharge Date:</strong> {{ discharge.discharge_date }}</p>
        <p><strong>Total Due:</strong> {{ discharge.total }}</p>

        {% if discharge.is_paid %}
          <span class="badge bg-success">Paid âœ…</span>
          {% if discharge.paid_at %}
            <p class="text-muted mt-2">Paid at: {{ discharge.paid_at }}</p>
          {% endif %}
        {% else %}
          <form method="post" action="{% url 'create-checkout-session' discharge.id %}">
            {% csrf_token %}
            <button type="submit" class="btn btn-primary">Pay</button>
          </form>
        {% endif %}
      </div>
    </div>
  {% endif %}
</div>

{% endblock %}
